<aside class="admin-sidebar" aria-label="Admin sidebar">
  <link rel="stylesheet" href="../assets/admin-theme.css" />
  <header class="sidebar-head">
    <div class="brand">
      <div class="brand-text-only">
        <h3 class="site-name">Vency</h3>
      </div>
    </div>

    <div class="controls">
      <button id="sidebarToggle" class="btn-toggle" aria-label="Toggle sidebar">
        <i class="bi bi-list"></i>
      </button>
    </div>
  </header>

  <nav class="nav-group" role="navigation">
    <a
      href="../Admin/index.html"
      target="_top"
      rel="noopener"
      class="nav-link"
      data-key="index.html"
    >
      <i class="bi bi-speedometer2" aria-hidden="true"></i>
      <span class="label">Dashboard</span>
    </a>

    <a
      href="../Admin/brand.html"
      target="_top"
      rel="noopener"
      class="nav-link"
      data-key="brand.html"
    >
      <i class="bi bi-award" aria-hidden="true"></i>
      <span class="label">Brand</span>
    </a>

    <a
      href="../Admin/product.html"
      target="_top"
      rel="noopener"
      class="nav-link"
      data-key="product.html"
    >
      <i class="bi bi-box-seam" aria-hidden="true"></i>
      <span class="label">Product</span>
    </a>

    <a
      href="../Admin/users.html"
      target="_top"
      rel="noopener"
      class="nav-link"
      data-key="users.html"
    >
      <i class="bi bi-people" aria-hidden="true"></i>
      <span class="label">Users</span>
    </a>

    <a
      href="../Admin/setting.html"
      target="_top"
      rel="noopener"
      class="nav-link"
      data-key="setting.html"
    >
      <i class="bi bi-gear" aria-hidden="true"></i>
      <span class="label">Setting</span>
    </a>

    <a
      href="../Admin/Review.html"
      target="_top"
      rel="noopener"
      class="nav-link"
      data-key="review.html"
    >
      <i class="bi bi-file-earmark-text" aria-hidden="true"></i>
      <span class="label">Reviews</span>
    </a>

    <a
      href="../Admin/content.html"
      target="_top"
      rel="noopener"
      class="nav-link"
      data-key="content.html"
    >
      <i class="bi bi-chat-left-text" aria-hidden="true"></i>
      <span class="label">Content</span>
    </a>

    <a
      href="../Admin/Order.html"
      target="_top"
      rel="noopener"
      class="nav-link"
      data-key="order.html"
    >
      <i class="bi bi-person-circle" aria-hidden="true"></i>
      <span class="label">Orders</span>
    </a>
  </nav>

  <footer class="sidebar-footer">
    <div class="admin-info">
      <div class="avatar" aria-hidden="true">
        <i class="bi bi-person-circle"></i>
      </div>
      <div class="info">
        <div class="name" id="sidebarAdminEmail">Administrator</div>
        <div class="role">Super Admin</div>
      </div>
    </div>
  </footer>

  <style>
    /* Theme variables are provided by ../assets/admin-theme.css */

    * {
      box-sizing: border-box;
    }
    .admin-sidebar {
      font-family: Inter, "Segoe UI", Roboto, "Helvetica Neue", Arial,
        sans-serif;
      width: var(--width);
      min-width: var(--width);
      height: 100vh;
      background: var(--sidebar-bg);
      color: var(--text);
      display: flex;
      flex-direction: column;
      padding: 14px;
      gap: 12px;
      transition: width 220ms ease;
    }

    .sidebar-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .brand-logo {
      width: 44px;
      height: 44px;
      border-radius: 8px;
      padding: 6px;
      background: #fff;
    }
    .brand-text-only h3 {
      margin: 0;
      font-size: 1.05rem;
      letter-spacing: 0.2px;
    }
    .brand-text-only small {
      color: var(--muted);
    }

    .controls {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .btn-toggle {
      background: transparent;
      border: 0;
      color: var(--muted);
      font-size: 1.05rem;
      padding: 6px;
      cursor: pointer;
    }

    .nav-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 6px;
      overflow: auto;
      padding-right: 6px;
    }

    .nav-link {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: 10px;
      text-decoration: none;
      color: var(--text);
      transition: background 150ms, transform 150ms, color 150ms;
      font-weight: 600;
      font-size: 0.95rem;
    }
    .nav-link i {
      font-size: 1.15rem;
      color: var(--accent);
      min-width: 20px;
      text-align: center;
    }
    .nav-link .label {
      flex: 1;
    }
    .nav-link:hover {
      background: rgba(255, 255, 255, 0.03);
      transform: translateX(4px);
      color: var(--accent);
    }
    .nav-link.active {
      background: linear-gradient(
        90deg,
        rgba(124, 158, 255, 0.08),
        rgba(124, 158, 255, 0.03)
      );
      color: var(--accent);
      box-shadow: inset 3px 0 0 0 var(--accent);
    }

    .sidebar-footer {
      margin-top: auto;
      padding-top: 8px;
      border-top: 1px solid rgba(255, 255, 255, 0.03);
    }
    .admin-info {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .avatar {
      width: 44px;
      height: 44px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.03);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.6rem;
      color: var(--muted);
    }
    .info .name {
      font-weight: 700;
    }
    .info .role {
      font-size: 0.85rem;
      color: var(--muted);
    }

    /* Collapsed state */
    .admin-sidebar.collapsed {
      width: var(--collapsed-width);
      min-width: var(--collapsed-width);
    }
    .admin-sidebar.collapsed .label {
      display: none;
    }
    .admin-sidebar.collapsed .brand-text-only {
      display: none;
    }
    .admin-sidebar.collapsed .sidebar-footer .info {
      display: none;
    }
    .admin-sidebar.collapsed .avatar {
      width: 36px;
      height: 36px;
    }
    .admin-sidebar.collapsed .nav-link {
      justify-content: center;
      padding: 10px;
    }

    /* small screens: overlay behavior */
    @media (max-width: 880px) {
      .admin-sidebar {
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        z-index: 9999;
        transform: translateX(0);
      }
    }

    /* thin scrollbar for nav */
    .nav-group::-webkit-scrollbar {
      width: 8px;
    }
    .nav-group::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.04);
      border-radius: 8px;
    }
  </style>

  <script>
    (function () {
      const sidebar = document.querySelector(".admin-sidebar");
      const toggle = document.getElementById("sidebarToggle");
      const links = Array.from(document.querySelectorAll(".nav-link"));
      const emailEl = document.getElementById("sidebarAdminEmail");

      // Restore collapsed state
      const collapsed = localStorage.getItem("vency_sidebar_collapsed") === "1";
      if (collapsed) sidebar.classList.add("collapsed");

      toggle.addEventListener("click", function () {
        const isCollapsed = sidebar.classList.toggle("collapsed");
        localStorage.setItem(
          "vency_sidebar_collapsed",
          isCollapsed ? "1" : "0"
        );
      });

      // Mark active link based on top window path (falls back to iframe path)
      try {
        const topPath =
          window.top && window.top.location && window.top.location.pathname
            ? window.top.location.pathname
            : window.location.pathname;
        const last = topPath.split("/").filter(Boolean).pop() || "index.html";
        links.forEach((a) => {
          const key =
            a.getAttribute("data-key") ||
            a.getAttribute("href").split("/").pop();
          if (key === last) a.classList.add("active");
        });
      } catch (e) {
        // Cross-origin or other access may fail; fallback to href compare
        const current = window.location.href;
        links.forEach((a) => {
          if (a.href === current) a.classList.add("active");
        });
      }

      // Fill admin email from token if present
      try {
        const token = localStorage.getItem("vency_admin_token");
        if (token) {
          try {
            const decoded = JSON.parse(atob(token));
            if (decoded && decoded.email) emailEl.textContent = decoded.email;
          } catch (err) {
            // ignore
          }
        }
      } catch (err) {
        // ignore localStorage issues
      }

      // Accessibility: add title attributes for collapsed view
      links.forEach((a) => {
        if (!a.getAttribute("title")) {
          const lbl = a.querySelector(".label");
          if (lbl) a.setAttribute("title", lbl.textContent.trim());
        }
      });
    })();
  </script>
</aside>
